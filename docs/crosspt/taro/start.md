---
order: 2
---

# å¼€å§‹ä½¿ç”¨ Taro

å…¨å±€å®‰è£… `@tarojs/cli` ä¹‹åï¼Œå¯åœ¨ç»ˆç«¯ä½¿ç”¨ taro å‘½ä»¤ã€‚

```sh
$ taro -v
ğŸ‘½ Taro v3.5.7
```

æˆ‘ä½¿ç”¨çš„ taro æœ€æ–°ç‰ˆæœ¬ä¸º v3.5.7ã€‚æ¨èä½¿ç”¨ v3.5 ä»¥ä¸Šçš„ç‰ˆæœ¬ï¼Œè¯¥ç‰ˆæœ¬å‡çº§äº† Webpack5ã€react18ã€H5 å¤šé¡µé¢æ¨¡å¼ç­‰ï¼Œè¯¦æƒ…å¯ä»¥æŸ¥çœ‹[åšå®¢](https://taro-docs.jd.com/blog/2022/07/26/Taro-3.5)ã€‚

ä½¿ç”¨ `taro init` å‘½ä»¤åˆ›å»ºé¡¹ç›®ï¼Œæ ¹æ®æç¤ºé€‰æ‹©é€‚åˆè‡ªå·±çš„æ¡†æ¶ï¼Œæˆ‘çš„é€‰æ‹©æ˜¯ React + Mobx + TypeScriptã€‚

```sh
$ taro init taro3-project
```

## åˆå§‹é…ç½®

é¡¹ç›®ç”Ÿæˆä¹‹åï¼Œè¿˜è¦å¯¹ä¸€äº›ç»†èŠ‚åšå‡ºä¿®è¡¥ã€‚

é¦–å…ˆé€šè¿‡æç¤ºå®‰è£…çš„ mobx ç‰ˆæœ¬è¾ƒä½ï¼Œä¸æ”¯æŒ `makeAutoObservable`ï¼Œå› æ­¤æˆ‘ä»¬è¦å‡çº§ mobx ä¾èµ–åŒ…å¦‚ä¸‹ï¼š

```json
{
  "mobx": "^6.3.6",
  "mobx-react": "^7.2.1"
}
```

é»˜è®¤é¡¹ç›®ä¸­æ²¡æœ‰é…ç½®è·¯å¾„åˆ«åã€‚æˆ‘ä»¬å¸Œæœ›åœ¨å¯¼å…¥æ–‡ä»¶æ—¶é€šè¿‡ `@` ç¬¦å·æ¥è¡¨ç¤º `src` ç›®å½•ï¼Œè¿™æ ·å¯ä»¥é¿å…ä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼Œæœ€ç»ˆæ•ˆæœå¦‚ä¸‹ï¼š

```js
import util from '@/utils.js';
```

å®ç°åˆ«åéœ€è¦åŒæ—¶é…ç½® Webpack å’Œ TypeScriptã€‚Webpack é…ç½®åœ¨ `config/index.js` æ–‡ä»¶ä¸­æ·»åŠ ï¼š

```js
const path = require("path");
// åˆ«åé…ç½®
alias: {
  "@": path.resolve(__dirname, "..", "src"),
},
```

TypeScript é…ç½®åœ¨ `tsconfig.json` æ–‡ä»¶ä¸­æ·»åŠ ï¼š

```json
{
  "compilerOptions": {
    "baseUrl": ".",
    "paths": {
      "@/*": ["src/*"]
    }
  }
}
```

é¡¹ç›®é»˜è®¤ä¼šå®‰è£… Eslint æ£€æµ‹ä»£ç ï¼Œæ‰“å¼€ config/ ä¸‹çš„é…ç½®æ–‡ä»¶æ—¶ä¼šæŠ¥é”™ï¼š

![](../images/2022-11-17-18-36-56.png)

é”™è¯¯ä¿¡æ¯æ˜¯è¯´ Eslint è¦æ±‚ä½¿ç”¨ ESM è¯­æ³•ï¼Œè€Œè¿™é‡Œä½¿ç”¨çš„æ˜¯ CommonJS è¯­æ³•ï¼Œå› æ­¤æŠ¥é”™ã€‚æ‰€ä»¥åœ¨ `.eslintrc.js` é…ç½®æ–‡ä»¶ä¸­ä¼šç•¥è¿™ä¸ªéªŒè¯ï¼š

```js
{
  rules: {
    ...
    "import/no-commonjs": "off",
  },
}
```

## H5 çš„å‘

é¡¹ç›®åˆ›å»ºä¹‹åï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿è¡Œ H5 é¡¹ç›®ï¼š

```sh
$ yarn run build:h5 --watch
```

è¿è¡Œååœ¨æµè§ˆå™¨ä¸­æ‰“å¼€é¡µé¢ï¼Œå‘ç°é¦–é¡µç™½å±ï¼Œæ‰“å¼€æ§åˆ¶å°æŠ¥é”™å¦‚ä¸‹ï¼š

![](../images/2022-11-17-15-45-24.png)

ç»è¿‡æŸ¥æ‰¾ï¼Œé”™è¯¯åŸå› æ˜¯ï¼šReact åœ¨ H5 Dev ç¼–è¯‘æ¨¡å¼æ—¶é»˜è®¤å¼€å¯äº†[fast refresh](https://github.com/facebook/react/issues/16604#issuecomment-528663101) åŠŸèƒ½ã€‚

è§£å†³æ–¹æ¡ˆï¼šå…³é—­ fast refreshã€‚åœ¨ Babel å’Œ Webpack ä¸­åŒæ—¶é…ç½® `hot: false`ï¼Œä¿®æ”¹ä»£ç å¦‚ä¸‹ï¼š

```js
// config/index.js
const config = {
  h5: {
    devServer: {
      hot: false,
    },
  },
};

// babel.config.js
presets: [
  [
    'taro',
    {
      framework: 'react',
      hot: false,
    },
  ],
];
```

è¿™ä¸ªé—®é¢˜è§£å†³ä¹‹åï¼Œé©¬ä¸Šä¼šé‡åˆ°ç¬¬äºŒä¸ªé—®é¢˜ã€‚æŠ¥é”™å¦‚ä¸‹ï¼š

![](../images/2022-11-17-15-59-52.png)

è¿™ä¸ªé”™è¯¯æ˜¯å› ä¸ºåœ¨å‡çº§ Webpack5 ä¹‹åï¼ŒWebpack ä¼šä»é…ç½®æ–‡ä»¶çš„ mode é€‰é¡¹è‡ªåŠ¨ä¸º process.env.NODE_ENV èµ‹å€¼ã€‚æ­¤æ—¶å¦‚æœå†é€šè¿‡ DefinePlugin æ’ä»¶å®šä¹‰ NODE_ENVï¼Œå°±ä¼šé€ æˆå®šä¹‰å†²çªï¼Œäºæ˜¯æŠ¥äº†ä¸Šé¢çš„é”™ã€‚

è§£å†³æ–¹æ¡ˆï¼šåœ¨ `config/dev.js` å’Œ `config/prod.js` æ³¨é‡Šæ‰ NODE_ENV çš„å®šä¹‰ï¼š

```js
module.exports = {
  env: {
    // NODE_ENV: '"production"',
  },
};
```

ä¿å­˜é‡æ–°è¿è¡Œï¼Œé¡¹ç›®ç»ˆäºèƒ½æ­£å¸¸è·‘èµ·æ¥äº†ã€‚
